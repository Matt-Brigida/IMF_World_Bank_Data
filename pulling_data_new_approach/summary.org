#+title: Summary of Data Set Sources and Construction
#+options: toc:nil


* Preliminaries

Load libraries:

#+begin_src R :session :results output :exports both 
library(stargazer)
library(plm)
library(dplyr)
library(WDI)
#+end_src


* Data Set Construction



** Macro Variables

Below is a summary of each variable and its source and description.


| Variable               | Source | Code             | Description                                                                                                                                                                  |
|------------------------+--------+------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Inflation              | IMF    | PCPI_PC_CP_A_PT  | Prices, Consumer Price Index, All items, Percentage change, Corresponding period previous year, Percent                                                                      |
| Unemployment Rate      | IMF    | LUR_PT           | Labor Markets, Unemployment Rate, Percent                                                                                                                                    |
| Gross Domestic Product | IMF    | NGDP_R_CH_SA_XDC | National Accounts, Expenditure, Gross Domestic Product, Real, Reference Chained, Seasonally adjusted, Domestic Currency                                                      |
| Debt                   | IMF    | BCG_GALM_G01_XDC | Fiscal, Budgetary Central Government, Assets and Liabilities, Debt (at Market Value), Classification of the stocks of assets and liabilities, 2001 Manual, Domestic Currency |
|                        |        |                  |                                                                                                                                                                              |

*** IMF Data

#+begin_src R :session :results output :exports both 


#+end_src



*** World Bank Data

#+begin_src R :session :results output :exports both 


#+end_src


*** Merged

#+begin_src R :session :results output :exports both 


#+end_src



** Mentions and Recommendations Data

*** Mentions

#+begin_src R :session :results output :exports both 
mentions <- read.csv("./raw_exp.txt", stringsAsFactors=FALSE, header=TRUE)
mentions$Topic <- gsub(",", "", mentions$Topic)
names(mentions)[1]  <- "Country"

## calculate % mentions for each topic by country/year group------

mentions <- mentions %>%
    group_by(Country, Year) %>%
    mutate(lhs = Mentions / sum(Mentions))

## make sure each row is unique----

mentionsIndex <- paste0(mentions$Country, "_", mentions$Year)
mentionsIndex <- gsub(" ", "", mentionsIndex)

mentions <- cbind(mentionsIndex, data.frame(mentions))

### Merge with IMF/WB Data

econ_vars_for_model <- econ[, c("country", "year", vars)]

## now need to extract only unique country and year subsets-----

econVarsIndex <- paste0(econ_vars_for_model$country, "_", econ_vars_for_model$year)

econ_vars_for_model <- cbind(econVarsIndex, econ_vars_for_model)

econ_vars_for_model <- subset(econ_vars_for_model, !duplicated(econ_vars_for_model$econVarsIndex))

#### Join data-----

mergedMentions <- merge(mentions, econ_vars_for_model, by.x = "mentionsIndex", by.y = "econVarsIndex")

mergedMentions <- mergedMentions[, c("Country", "Year", "Mentions", "lhs", vars)]

### mergedMentionsED <- mergedMentionsED[complete.cases(mergedMentionsED), ]

## convert to plm
#### mergedMentionsED_p <- pdata.frame(mergedMentionsED, index = c("Country", "Year"), drop.index=FALSE, row.names=TRUE)

write.csv(mergedMentions, "merged_metions.csv")

#+end_src

*** Recommendations
